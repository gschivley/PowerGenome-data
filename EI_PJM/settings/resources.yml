######################################################
# THESE PARAMETERS ARE OFTEN MODIFIED FOR NEW STUDIES
######################################################

#####################
# Existing generators
#####################

# DATA YEAR
# Pick one or more years of generator data to use when creating clusters. If
# more than one year is used then things like heat rate will be calculated as the
# average (weighted by generation per year).
# eia_data_years:
#   - 2020

# eia_860m_fn: april_generator2023.xlsx

# CAPACITY TYPE
# capacity_col: winter_capacity_mw

# CLUSTERING
# Existing thermal power plants are clusted to reduce the number of distinct plants.
# The existing method (for now) is to specify the number of clusters for each type
# of thermal plant as a default and then specify specific values for any regions
# that are different.

# Include units with planned/age-based retirements when determining clusters across periods
cluster_with_retired_gens: true

# ** Any technologies not included in num_clusters will be omitted **
num_clusters:
  Conventional Steam Coal: 1
  Natural Gas Fired Combined Cycle: 1
  Natural Gas Fired Combustion Turbine: 1
  Nuclear: 1
  Conventional Hydroelectric: 1
  Wood/Wood Waste Biomass: 1
  Natural Gas Internal Combustion Engine: 1
  Natural Gas Steam Turbine: 1
  Geothermal: 1
  Solar Photovoltaic: 1
  Onshore Wind Turbine: 1
  Offshore Wind Turbine: 1
  # Solar Thermal with Energy Storage: 1
  # Solar Thermal without Energy Storage: 1
  Small Hydroelectric: 1
  Petroleum Liquids: 1
  Landfill Gas: 1
  Municipal Solid Waste: 1
  Other Waste Biomass: 1
  Hydroelectric Pumped Storage: 1
  Biomass: 1
  Other_peaker: 1
  Batteries: 1
  Run of River Hydroelectric: 1


# Group these technologies
group_technologies: True
tech_groups:
  Biomass:
    - Wood/Wood Waste Biomass
    - Landfill Gas
    - Municipal Solid Waste
    - Other Waste Biomass
  Other_peaker:
    - Natural Gas Internal Combustion Engine
    - Petroleum Liquids

# Use this to avoid grouping technologies in some regions
regional_no_grouping: ~

# Add code to ensure region names here are included above
alt_num_clusters: ~


# Derate the capacity of technologies that will be set as MUST_RUN in GenX by their
# historical capacity factor.
derate_techs:
  - Small Hydroelectric
  - Biomass

# Default value to limit the years used to calculate capacity factors.
# PUDL currently has generation data from 2011 through the most recent final release of 923/860.
capacity_factor_default_year_filter: [2016, 2017, 2018, 2019, 2020, 2021]


# LABEL SMALL HYDRO
small_hydro: true
small_hydro_mw: 30
small_hydro_regions:
  - p1_2
  - p3
  - p4



# Factors for calculating hydro energy to power ratio in GenX. The default factors is
# numeric and will be applied to all regions. The regional factors are a dictionary mapping
# model region names to specific regional factors. The factors are multiplied by average
# annual inflow rates to determine the rated number of hours of reservoir hydro
# storage at peak discharge power output.
hydro_factor: 4

regional_hydro_factor:
  p1_2: 4
  p3: 4
  p4: 4

# Energy storge duration. Provide a default value for existing resources of a given type.
# The value of 15.5 for pumped hydro comes from https://sandia.gov/ess-ssl/gesdb/public/statistics.html
# Default value can be numeric or a dictionary of region: numeric values. Technology names
# here and in the dataframe are both converted to snake case and matches are made if this
# name is contained in the dataframe technology name.
energy_storage_duration:
  Hydroelectric Pumped Storage: 15.5
  Batteries: 2


# The year of NREL ATB data to use for matching existing generators (O&M costs)
atb_existing_year: 2020

resource_attr_modifiers:
  conventional steam coal:
    - attribute: fom_per_mwyr
      formula:
        op: add
        rate: 126 # 0.126 $/kW-yr per year of age
        multiplier: age

#####################
# New-build generators
#####################
# Generator cost data from NREL ATB
resource_data_year: 2024
resource_financial_case: Market
resource_cap_recovery_years: 20

# Alternate capital recovery periods for specific technologies, which are used to calculate
# the annual investment costs. The names are matched using str.contains rather than
# exact matches. Set parameter value to none (~) if not used.
alt_resource_cap_recovery_years:
  Battery: 15
  Nuclear: 40

# Use Class3 onshore wind, Class 3 for fixed offshore wind, and Class 12 for floating offshore wind
# Format for each list item is <technology>, <tech_detail>, <cost_case>, <size>
# atb_new_gen:
#   - [NaturalGas, 1-on-1 Combined Cycle (H-Frame), Moderate, 500]
#   # - [NaturalGas, Combustion Turbine (F-Frame), Moderate, 100]
#   - [LandbasedWind, Class3, Moderate, 1]
#   # - [OffShoreWind, Class12, Moderate, 1]
#   # - [OffShoreWind, Class3, Moderate, 1]
#   # - [UtilityPV, Class1, Moderate, 1]
#   - [Utility-Scale Battery Storage, Lithium Ion, Moderate, 1]
#   - [Nuclear, Nuclear - Large, Moderate, 1000]

new_resources:
  - [NaturalGas, 2-on-1 Combined Cycle (F-Frame), Moderate, 500]
  # - [NaturalGas, 2-on-1 Combined Cycle (F-Frame) 95% CCS, Moderate, 500]
  - [NaturalGas, Combustion Turbine (F-Frame), Moderate, 100]
  - [LandbasedWind, Class3, Moderate, 1]
  # - [OffShoreWind, Class12, Moderate, 1]
  # - [OffShoreWind, Class3, Moderate, 1]
  - [UtilityPV, Class1, Moderate, 1]
  - [Utility-Scale Battery Storage, Lithium Ion, Moderate, 1]
  - [Nuclear, Nuclear - Large, Moderate, 1000]

# Interconnection cost per MW to connect new generators to the transmission system
# Resource Groups (as defined in RESOURCE_GROUPS) define site-specific interconnection costs.
# This is for generic costs that apply to other new generators not in resource groups.
# Costs should be in the same dollar year as output data (target_usd_year).

# Method 1: flat rate for all generators
interconnect_capex_mw: 100000

# Method 2: use a key "default". This can be useful if mixing with other methods.
# interconnect_capex_mw:
#   default: 100000

# Method 3: different rates by region
# interconnect_capex_mw:
#   p1_2: 100000
#   p3: 100000
#   p4: 100000

# Method 4: different rates by technology (substring match to new_resources)
# interconnect_capex_mw:
#   NaturalGas: 100000
#   Nuclear: 150000

# Method 5: different rates by region and technology, where region is the top-level key
# interconnect_capex_mw:
#   p1_2:
#     NaturalGas: 100000
#     Nuclear: 150000
#   p3:
#     NaturalGas: 120000
#     Nuclear: 170000
#   p4:
#     NaturalGas: 110000
#     Nuclear: 160000

# Method 6: different rates by technology and region, where technology is the top-level key
# interconnect_capex_mw:
#   NaturalGas:
#     p1_2: 100000
#     p3: 120000
#     p4: 110000
#   Nuclear:
#     p1_2: 150000
#     p3: 170000
#     p4: 160000

# Combine default with specific overrides
# interconnect_capex_mw:
#   default: 100000
#   p1_2: 120000
#   p3:
#     Nuclear: 170000
#   p4:
#     NaturalGas: 110000

# DOES NOT WORK: Combine region and technology at the same level. Will raise an error.
# interconnect_capex_mw:
#   default: 100000
#   NaturalGas: 120000
#   p1_2:
#     NaturalGas: 120000
#   p3:
#     Nuclear: 170000

cache_resource_clusters: true
use_resource_clusters_cache: true
renewables_clusters:
  - region: all
    technology: landbasedwind
    filter:
      - feature: lcoe
        max: 70
    bin:
      - feature: lcoe
        weights: capacity_mw
        # q: 3
        mw_per_bin: 10000
        # bins: [0, 40, 55, 76]
      # - feature: cf
      #   q: 2
    cluster:
      - feature: cf
        n_clusters: 5
        method: agg
  
  - region: all
    technology: utilitypv
    filter:
      - feature: lcoe
        max: 40
    bin:
      - feature: lcoe
        weights: capacity_mw
        mw_per_bin: 50000
    cluster:
      - feature: lcoe
        n_clusters: 5
        method: agg


# The atb_modifers parameter is used here to add a VOM cost to battery technologies. PNNL
# reports a 0.03 cents per kWh VOM, which is split between Var_OM_Cost_per_MWh and
# Var_OM_Cost_per_MWh_In (https://www.pnnl.gov/main/publications/external/technical_reports/PNNL-28866.pdf).
# Because Var_OM_Cost_per_MWh_In is not part of the ATB database the value should be set
# directly rather than using a list of [operator, value]. Operators ("add", "mul",
# "truediv", and "sub") can only be used to modify values that exist in the ATB database.
# atb_modifiers:
#   batteries:
#     technology: Utility-Scale Battery Storage
#     tech_detail: Lithium Ion
#     Var_OM_Cost_per_MWh: [add, 0.15]
#     Var_OM_Cost_per_MWh_In: 0.15

resource_modifiers:
  batteries:
    technology: Utility-Scale Battery Storage
    tech_detail: Lithium Ion
    Var_OM_Cost_per_MWh: [add, 0.15]
    Var_OM_Cost_per_MWh_In: 0.15
    wacc_real: 0.0467


# Copy and modify an existing ATB new generator. Set parameter to none (~) if not adding
# any modified generators.

# modified_new_resources:
#   hydrogen_turbine:
#     technology: NaturalGas
#     tech_detail: 1-on-1 Combined Cycle (H-Frame)
#     cost_case: Moderate
#     size_mw: 100
#     new_technology: hydrogen
#     new_tech_detail: 1-on-1 Combined Cycle (H-Frame)
#     new_cost_case: Moderate

######################################################
# MODIFY THESE PARAMETERS FOR NEW REGIONAL AGGREGATIONS
######################################################


# Map user-regions to AEO Electricity Market Module (EMM) regions for cost multipliers
# IPM regions have been pre-populated in the lists below, but any user defined regions
# must also be added. This cannot be mapped automatically since user regions might
# cut across EMM regions.
# See a map at https://www.eia.gov/outlooks/aeo/pdf/nerc_map.pdf
# cost_multiplier_region_map:
#   BASN: [p12, p13, p15, p16, p21, p25, p26]
#   CANO: [p9]
#   CASO: [p10, p11]
#   FRCC: [p101, p102]
#   ISNE: [p129, p130, p131, p132, p133, p134]
#   MISC: [p71, p72, p73, p81, p82, p83, p84, p105, p106, p107]
#   MISE: [p103]
#   MISS: [p58, p66, p85, p86, p87]
#   MISW: [p42, p43, p44, p68, p69, p70, p74, p75, p76, p77, p78, p79]
#   NWPP: [p1_2, p1, p2, p3, p4, p5, p6, p7, p8, p14, p17, p18, p19, p20]
#   NYCW: [p128]
#   NYUP: [p127]
#   PJMC: [p80]
#   PJMD: [p99]
#   PJME: [p119, p120, p122, p123, p124, p125, p126]
#   PJMW: [p100, p104, p110, p111, p112, p113, p114, p115, p116, p117, p118, p121]
#   RMRG: [p22, p23, p24, p32, p33, p34]
#   SPPC: [p52, p53, p54, p55]
#   SPPN: [p35, p36, p37, p38, p39, p40, p41, p45, p46]
#   SPPS: [p47, p48, p49, p50, p51, p56, p57]
#   SRCA: [p95, p96, p97, p98]
#   SRCE: [p88, p92, p93, p108, p109]
#   SRSE: [p89, p90, p91, p94]
#   SRSG: [p27, p28, p29, p30, p31, p59]
#   TRE: [p60, p61, p62, p63, p64, p65, p67]

######################################################
# THESE PARAMETERS ARE RARELY MODIFIED FOR NEW STUDIES
######################################################
# ATB doesn't have a WACC for battery tech. Need to provide a value here.
atb_battery_wacc: UtilityPV


# Dictionary of lists with model region as key and ATB tech (string matching) in list.
# It isn't necessary to include wind/solar resources here. If they aren't included in
# the renewables_clusters parameter below, they won't be included in the final generators
# dataframe.
new_gen_not_available: ~


# The keys in cost_multiplier_technology_map are technologies listed in EIA's capital
# cost assumptions document. The 2020 version is available at
# https://www.eia.gov/outlooks/archive/aeo20/assumptions/pdf/table_8.2.pdf
# Values in the list are string-matched to technologies (`<tech>_<tech_detail>`) from ATB.
# Be sure to include any custom technologies you are using from `additional_technologies_fn`
# or `modified_atb_new_gen`.
# If a value in one of the lists matches more than one technology, the cost multiplier
# will only be applied to the first technology.
# If you want to modify the regional cost corrections CSV, you can put your own copy in
# the folder PowerGenome/data/cost_multipliers.
# cost_multiplier_fn: AEO_2020_regional_cost_corrections.csv
# cost_multiplier_technology_map:
#   Ultra-supercritical coal (USC): [Coal_newAvgCF, Coal_newHighCF]
#   # IGCC: [Coal_IGCCAvgCF, Coal_IGCCAvgCF]
#   USC with 30% CCS: [Coal_CCS30AvgCF, Coal_CCS30HighCF]
#   USC with 90% CCS: [Coal_CCS90AvgCF, Coal_CCS90HighCF]
#   CT - aeroderivative: []
#   CT - industrial frame: [NaturalGas_CTAvgCF, NaturalGas_CTHighCF, NaturalGas_Combustion Turbine (F-Frame)]
#   CC - single shaft: [NaturalGas_1-on-1 Combined Cycle (H-Frame)]
#   CC - multi shaft: [NaturalGas_CCAvgCF, NaturalGas_CCHighCF, NaturalGas_2-on-1 Combined Cycle (H-Frame)]
#   CC with 90% CCS: [NaturalGas_CCCCSAvgCF, NaturalGas_CCCCSHighCF, NGCCS100, NaturalGas_CCS100, NaturalGas_CCS100_low,NaturalGas_CCS100_high]
#   Fuel cells: []
#   Advanced nuclear: [Nuclear_Nuclear, Nuclear_mid, Nuclear_low, Nuclear_high, Nuclear_Nuclear - Large]
#   Biomass: [Biopower_CofireOld, Biopower_CofireNew, Biopower_Dedicated]
#   MSW - landfill gas: []
#   Wind: [LandbasedWind_Class3]
#   Wind offshore: [OffShoreWind_Class3, OffShoreWind_Class12]
#   Solar thermal: [CSP]
#   Solar PV - tracking: [UtilityPV_Class1, CommPV, ResPV]
#   Battery storage: [Utility-Scale Battery Storage_Lithium Ion, Storage_LongDuration]
#   Geothermal: [Geothermal_HydroBinary, Geothermal_HydroFlash, Geothermal_NFEGSBinary, Geothermal_DeepEGSBinary, Geothermal_NFEGSFlash, Geothermal_DeepEGSFlash]
#   Conventional hydropower: [Hydropower]